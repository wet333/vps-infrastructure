version: '3'

services:
  homepage:
    image: wetagustin/vps-homepage:latest
    expose:
      - "80"
    environment:
      - VIRTUAL_HOST=agustinwet.online
      - LETSENCRYPT_HOST=agustinwet.online
      - LETSENCRYPT_EMAIL=wet.4gustin@gmail.com
    networks:
      - proxy-net

  typescript-api:
    image: wetagustin/vps-typescript-api:latest
    expose:
      - "3000"
    environment:
      - VIRTUAL_HOST=api.agustinwet.online
      - LETSENCRYPT_HOST=api.agustinwet.online
      - LETSENCRYPT_EMAIL=wet.4gustin@gmail.com
    networks:
      - proxy-net

  # Copy created only for testing purposes
  typescript-api2:
    image: wetagustin/vps-typescript-api:latest
    expose:
      - "3000"
    environment:
      - VIRTUAL_HOST=node1.agustinwet.online
      - LETSENCRYPT_HOST=node1.agustinwet.online
      - LETSENCRYPT_EMAIL=wet.4gustin@gmail.com
    networks:
      - proxy-net

networks:
  proxy-net:
    external:
      name: nginx-proxy
